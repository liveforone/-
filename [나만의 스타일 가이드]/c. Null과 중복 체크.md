# Null체크와 중복체크

## 목차
1. 왜 Null을 체크해야하는가?
2. 효과적인 Null 체크법
3. 왜 중복을 체크해야하는가?
4. 효과적인 중복 체크법
5. 결론

## 1. 왜 Null을 체크해야하는가?
* 간혹 api 테스트를 하다보면 잘못된 방법으로 api를 호출하는 경우가 있다.
* 예를 들어 존재하지 않는 게시글에 진입하는 경우를 예시로 들 수 있다.
* 이때 화면에는 불친절한 에러메세지가 뜨고
* 서버단에서는 NPE, 즉 널포인터예외가 뜬다.
* 런타임에러는 최소화하는 것이 어플리케이션에 유익하다.
* 또한 사용자가 실수로 혹은 일부러 잘못된 api 경로에 들어왔을때 적절한 메세지를 넘겨주는 섬세함도 필요하다.
* 이러한 이유로 Null을 체크해야한다.

## 2. 효과적인 Null 체크법
* 기본적으로 스프링 시큐리티를 사용하면 권한을 갖지 않은 유저는 api에 함부로 진입하지 못한다.
* 이것으로 유저에 대한 Null을 쉽게 체크할 수 있다.
* 유저의 경우 이렇게 해결하면 되지만 객체는 그렇지 못하다
* 유저가 아닌 다른 객체는 Null을 체크하는 함수를 만들어 전역으로 사용한다면 아주 좋다.
* 즉 전역 유틸 클래스를 만들고 그 안에 Null체크 함수를 만들면된다.
* 객체의 종류는 상당히 다양하다.
* 컬렉션, Object, String, Multipart등 다양하다.
* 아래는 예시이다.
```
public static boolean isNull(Object obj) {

    //일반 객체 체크
    if(obj == null) {
        return true;
    }

    //문자열 체크
    if ((obj instanceof String) && (((String)obj).trim().length() == 0)) {
        return true;
    }

    //리스트 체크
    if (obj instanceof List) {
        return ((List<?>)obj).isEmpty();
    }

    return false;
}
```

## 3. 왜 중복을 체크해야하는가?
* 중복은 NPE처럼 대놓고 에러라 하지 않는다.
* 이것이 Null보다 위험한 이유이다.
* 명시적이지 않은 논리 에러이기 때문에 어디서 문제가 발생했는지 찾기도 어렵다.
* 무슨 경우라도 중복은 항상 체크하는것이 좋다. 절대 넘어가지말자!

## 4. 효과적인 중복 체크법
* 대표적으로 팔로잉을 예시로 들 수 있다.
* follow라는 데이터에는 팔로잉을 하는 유저와, 팔로잉을 당하는 유저가 존재할것이다.
* 두 유저의 정보로 데이터를 조회하여 데이터가 존재한다면 중복이고
* 존재하지 않는다면 그에 맞는 액션을 취해주면된다.
* 아래는 예시이다.
```
//함수는 부정의 의미를 가진다.
//중복인가? 라는 함수의 물음에 true는 중복, false는 중복 아님을 의미한다.
public boolean isDulplicateFollow(Member follower, Member owner) {
    Follow checkDuplicate = followerService.getFollowDetail(follower, owner);

    if (checkDuplicate == null) {  //널이라는 것은 중복이 아니라는 뜻
        return false;  
    } else {
        return true;
    }
}
```

## 5. 결론
* Null체크와 중복체크는 함부로 넘어가서는 안된다.
* 특히나 눈으로 보이지 않는 논리 에러는 정말 수십번 체크해도 아깝지 않다.
* 팔로잉을 대표적인 예시로 들었지만 중복을 체크해야하는 경우는 생각보다 많다.
* 중복 체크가 필요하다면 주저없이 체크하라!!
* Null 또한 객체를 클라이언트에게 넘겨주는 행위라면 반드시!! 체크하라.
